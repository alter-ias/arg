<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Prompt Lab - Pollinations</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .glass { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); }
        body { background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); min-height: 100vh; color: white; }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #3b82f6; border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; display: none; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-5xl mx-auto">
        <header class="mb-10 text-center">
            <h1 class="text-4xl font-bold mb-2 bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-500">
                Generador de Prompts & Acción
            </h1>
            <p class="text-slate-400">Crea escenas visuales y comportamientos de IA en un solo clic</p>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <section class="glass p-6 rounded-2xl shadow-xl">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-1 text-blue-300">SUJETO</label>
                        <input type="text" id="subject" placeholder="Ej: Un astronauta cyberpunk" class="w-full bg-slate-800 rounded-lg p-3 outline-none focus:ring-2 ring-blue-500 border border-slate-700">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1 text-purple-300">ESCENARIO</label>
                        <input type="text" id="scenario" placeholder="Ej: Mercado flotante en Marte" class="w-full bg-slate-800 rounded-lg p-3 outline-none focus:ring-2 ring-purple-500 border border-slate-700">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1 text-emerald-300">ACCIÓN</label>
                        <input type="text" id="action" placeholder="Ej: Comprando una fruta brillante" class="w-full bg-slate-800 rounded-lg p-3 outline-none focus:ring-2 ring-emerald-500 border border-slate-700">
                    </div>
                    
                    <button onclick="processPrompt()" id="genBtn" class="w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 p-4 rounded-xl font-bold transition-all transform hover:scale-[1.02] flex justify-center items-center gap-2">
                        <span>GENERAR SISTEMA</span>
                        <div id="loader" class="loader"></div>
                    </button>
                </div>
            </section>

            <section class="space-y-6">
                <div class="glass p-4 rounded-2xl text-center">
                    <h2 class="text-xs uppercase tracking-widest text-slate-400 mb-3 font-bold">Previsualización Visual</h2>
                    <div id="imageContainer" class="aspect-square rounded-lg bg-slate-900 flex items-center justify-center overflow-hidden border border-slate-700">
                        <span class="text-slate-600 italic">La imagen aparecerá aquí...</span>
                    </div>
                    <p id="imagePromptText" class="mt-3 text-xs text-slate-500 italic"></p>
                </div>

                <div class="glass p-6 rounded-2xl border-l-4 border-emerald-500">
                    <h2 class="text-xs uppercase tracking-widest text-emerald-400 mb-2 font-bold">Comportamiento de la IA (Action Prompt)</h2>
                    <div id="actionPromptResult" class="text-slate-300 text-sm leading-relaxed min-h-[100px]">
                        Aquí se generará el comportamiento detallado del modelo de IA basado en tu escena.
                    </div>
                    <button onclick="copyAction()" class="mt-4 text-xs bg-slate-700 hover:bg-slate-600 px-3 py-1 rounded transition-colors">Copiar Acción</button>
                </div>
            </section>
        </div>
    </div>

    <script>
        async function processPrompt() {
            const subject = document.getElementById('subject').value;
            const scenario = document.getElementById('scenario').value;
            const action = document.getElementById('action').value;
            const btn = document.getElementById('genBtn');
            const loader = document.getElementById('loader');

            if (!subject || !scenario || !action) {
                alert("Por favor rellena los tres campos");
                return;
            }

            // UI State
            btn.disabled = true;
            loader.style.display = "block";

            // 1. Generar la Imagen (Directo a Pollinations Image API)
            // Usamos un estilo cinematográfico por defecto
            const imagePrompt = `Cinematic photo of ${subject}, ${action}, in ${scenario}, highly detailed, 8k, photorealistic, intricate textures, dramatic lighting --ar 1:1`;
            const encodedImgPrompt = encodeURIComponent(imagePrompt);
            const imageUrl = `https://image.pollinations.ai/prompt/${encodedImgPrompt}?model=flux&width=1024&height=1024&nologo=true`;
            
            document.getElementById('imageContainer').innerHTML = `<img src="${imageUrl}" class="w-full h-full object-cover" alt="Generated AI Image">`;
            document.getElementById('imagePromptText').innerText = "Visual Prompt: " + imagePrompt;

            // 2. Generar el Prompt de Acción (Usando Pollinations Text API)
            const systemContext = "Eres un experto en diseño de agentes de IA. Tu tarea es convertir una descripción de escena en un 'Action Prompt' técnico que defina cómo debe actuar y responder un personaje de IA en ese contexto.";
            const userQuery = `Sujeto: ${subject}. Escenario: ${scenario}. Acción: ${action}. Crea un Action Prompt profesional para este personaje.`;
            
            try {
                const response = await fetch(`https://text.pollinations.ai/${encodeURIComponent(userQuery)}?system=${encodeURIComponent(systemContext)}&model=openai`);
                const data = await response.text();
                document.getElementById('actionPromptResult').innerText = data;
            } catch (error) {
                document.getElementById('actionPromptResult').innerText = "Error generando la acción. Inténtalo de nuevo.";
            } finally {
                btn.disabled = false;
                loader.style.display = "none";
            }
        }

        function copyAction() {
            const text = document.getElementById('actionPromptResult').innerText;
            navigator.clipboard.writeText(text);
            alert("¡Copiado al portapapeles!");
        }
    </script>
</body>
</html>
