<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IRONIUS - La Verdad (aunque duela)</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Chomsky&family=Prata&family=Roboto+Mono:wght@400;700&family=Oswald:wght@300;500;700&display=swap" rel="stylesheet">
    
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <style>
        body {
            font-family: 'Roboto Mono', monospace;
            background-color: #f4f1ea; /* Color papel viejo */
            background-image: radial-gradient(#d1d1d1 1px, transparent 1px);
            background-size: 20px 20px;
        }
        .font-headline {
            font-family: 'Prata', serif;
        }
        .font-tabloid {
            font-family: 'Oswald', sans-serif;
        }
        .paper-shadow {
            box-shadow: 10px 10px 0px 0px rgba(0,0,0,1);
            border: 2px solid black;
        }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Estilos selecci√≥n */
        .style-card.selected {
            background-color: #fef08a; /* Amarillo post-it */
            border-color: #000;
            transform: translate(-4px, -4px);
            box-shadow: 4px 4px 0px 0px #000;
        }
        .style-card {
            transition: all 0.2s;
        }
    </style>
</head>
<body class="text-black min-h-screen flex flex-col relative selection:bg-yellow-300">

    <header class="bg-black text-white border-b-4 border-black sticky top-0 z-20">
        <div class="bg-yellow-400 text-black text-xs font-bold py-1 overflow-hidden whitespace-nowrap border-b-2 border-black">
            <div class="inline-block animate-marquee px-4 uppercase tracking-widest">
                üö® √öLTIMA HORA: El SAT cobrar√° impuestos por so√±ar bonito ‚Äî Estudio revela que tu ex ya es feliz y t√∫ no ‚Äî Cient√≠ficos descubren que el lunes dura 48 horas ‚Äî
            </div>
        </div>

        <div class="max-w-6xl mx-auto px-4 py-6 flex flex-col md:flex-row items-center justify-between gap-4">
            <div class="flex items-center gap-4">
                <div class="bg-white text-black p-2 border-2 border-black rotate-3">
                    <i class="ph-fill ph-newspaper-clipping text-4xl"></i>
                </div>
                <div>
                    <h1 class="text-5xl md:text-6xl font-headline tracking-tighter leading-none">IRONIUS</h1>
                    <p class="text-xs md:text-sm text-gray-400 font-mono uppercase tracking-widest mt-1">"Periodismo serio, pero de broma"</p>
                </div>
            </div>
            
            <div class="flex flex-col items-end">
                <div class="text-xs font-bold bg-red-600 text-white px-2 py-1 rotate-[-2deg] mb-1">EDICI√ìN IMPRESA CON L√ÅGRIMAS</div>
                <div class="text-[10px] font-mono text-gray-400">VOL. 666 | PRECIO: TU DIGNIDAD</div>
            </div>
        </div>
    </header>

    <main class="max-w-6xl mx-auto px-4 py-8 grid grid-cols-1 lg:grid-cols-12 gap-8 w-full flex-grow">
        
        <div class="lg:col-span-4 space-y-6">
            
            <div class="bg-white p-6 paper-shadow">
                
                <label class="block text-sm font-black font-tabloid uppercase mb-2 bg-black text-white inline-block px-2 transform -rotate-1">
                    1. ¬øA qui√©n vamos a destruir hoy?
                </label>
                <textarea
                    id="topicInput"
                    rows="3"
                    placeholder="Ej. Los precios de Starbucks, La gente que usa Crocs, La pol√≠tica nacional..."
                    class="w-full bg-gray-100 border-2 border-black text-black text-lg font-mono p-4 mb-6 focus:bg-yellow-50 focus:outline-none focus:ring-0 placeholder-gray-500 resize-none"
                ></textarea>

                <label class="block text-sm font-black font-tabloid uppercase mb-3 bg-black text-white inline-block px-2 transform rotate-1">
                    2. Elige el Tono del Redactor
                </label>
                <div class="grid grid-cols-1 gap-3 mb-6">
                    
                    <button onclick="selectStyle('deforma')" id="style-deforma" class="style-card flex items-center gap-3 p-3 border-2 border-gray-300 hover:border-black text-left group selected">
                        <div class="bg-black text-white p-2 border border-black"><i class="ph-fill ph-article"></i></div>
                        <div>
                            <div class="text-sm font-bold font-tabloid uppercase">Estilo "El Deforma"</div>
                            <div class="text-[10px] font-mono">Pseudoperiodismo serio, absurdo y c√≠nico.</div>
                        </div>
                    </button>
                    
                    <button onclick="selectStyle('barrio')" id="style-barrio" class="style-card flex items-center gap-3 p-3 border-2 border-gray-300 hover:border-black text-left group">
                        <div class="bg-black text-white p-2 border border-black"><i class="ph-fill ph-speaker-high"></i></div>
                        <div>
                            <div class="text-sm font-bold font-tabloid uppercase">Cr√≥nica de Barrio</div>
                            <div class="text-[10px] font-mono">Relato urbano, exagerado y con jerga callejera.</div>
                        </div>
                    </button>

                    <button onclick="selectStyle('conspiracion')" id="style-conspiracion" class="style-card flex items-center gap-3 p-3 border-2 border-gray-300 hover:border-black text-left group">
                        <div class="bg-black text-white p-2 border border-black"><i class="ph-fill ph-alien"></i></div>
                        <div>
                            <div class="text-sm font-bold font-tabloid uppercase">Teor√≠a de Conspiraci√≥n</div>
                            <div class="text-[10px] font-mono">Todo est√° conectado, gorritos de aluminio.</div>
                        </div>
                    </button>
                </div>

                <button
                    onclick="generateContent()"
                    id="generateBtn"
                    class="w-full flex items-center justify-center gap-2 bg-red-600 hover:bg-red-700 text-white font-black font-tabloid tracking-widest text-xl py-4 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] active:translate-y-1 active:shadow-none transition-all disabled:opacity-50 disabled:cursor-not-allowed"
                >
                    <i class="ph-bold ph-printer"></i> ¬°CREAR NOTICIA FALSA!
                </button>
            </div>
            
            <div class="bg-yellow-200 p-4 paper-shadow text-center opacity-90 border-dashed border-2 border-black">
                <p class="text-[10px] font-bold uppercase mb-2">Publicidad Pagada</p>
                <h4 class="font-headline font-bold text-xl leading-tight">¬øCansado de tener dignidad?</h4>
                <p class="font-mono text-xs mt-2">Prueba "Lloradita 3000". Llorar en el ba√±o de la oficina nunca fue tan c√≥modo.</p>
                <button class="mt-3 bg-black text-white px-3 py-1 text-xs font-bold uppercase hover:bg-gray-800">Comprar ahora</button>
            </div>
        </div>

        <div class="lg:col-span-8">
            
            <div id="emptyState" class="h-full min-h-[500px] flex flex-col items-center justify-center bg-white paper-shadow p-10 text-center opacity-80" style="background-image: url('https://www.transparenttextures.com/patterns/dust.png');">
                <div class="bg-gray-100 p-6 rounded-full mb-6 border-2 border-dashed border-gray-400">
                    <i class="ph-duotone ph-article text-5xl text-gray-400"></i>
                </div>
                <h3 class="text-2xl font-headline font-bold mb-2">Redacci√≥n Vac√≠a</h3>
                <p class="font-mono text-sm text-gray-500 max-w-sm mx-auto">
                    Los becarios est√°n durmiendo. Dales un tema para que inventen una noticia que ofenda a alguien.
                </p>
            </div>

            <div id="loadingState" class="hidden h-full min-h-[500px] flex flex-col items-center justify-center bg-yellow-50 paper-shadow p-10 text-center">
                <div class="relative mb-6">
                    <div class="w-20 h-20 border-8 border-black border-t-yellow-500 rounded-full animate-spin"></div>
                    <div class="absolute inset-0 flex items-center justify-center">
                        <i class="ph-fill ph-typewriter text-black text-2xl animate-pulse"></i>
                    </div>
                </div>
                <h3 class="text-xl font-bold font-tabloid uppercase tracking-wider" id="loadingText">Inventando Datos Falsos...</h3>
                <p class="text-xs font-mono mt-2 text-gray-600">Entrevistando gente imaginaria...</p>
            </div>

            <div id="resultState" class="hidden bg-[#fffdf5] paper-shadow flex flex-col min-h-[600px] fade-in relative">
                <div class="absolute inset-0 opacity-5 pointer-events-none flex items-center justify-center overflow-hidden">
                    <span class="text-[150px] font-black -rotate-45">IRONIUS</span>
                </div>

                <div class="bg-black text-white px-4 py-2 flex justify-between items-center border-b-2 border-black">
                    <div class="font-mono text-xs text-yellow-400">SECCI√ìN: <span id="sectionLabel">NACIONAL</span></div>
                    <div class="flex gap-3">
                         <span class="text-[10px] bg-red-600 px-1 rounded text-white font-bold">FAKE NEWS</span>
                    </div>
                </div>

                <div class="p-8 md:p-12 relative z-10">
                    <div class="border-b-4 border-black pb-6 mb-8">
                        <h2 class="font-headline text-4xl md:text-6xl font-bold leading-none mb-4 tracking-tight" id="resultTitle">
                            TITULAR
                        </h2>
                        <h3 class="font-mono text-lg md:text-xl text-gray-600 italic leading-snug mb-4" id="resultSubtitle">
                            Subt√≠tulo sarc√°stico aqu√≠.
                        </h3>
                        <div class="flex flex-col md:flex-row md:justify-between md:items-center text-xs font-mono text-gray-500 border-t-2 border-gray-200 pt-3 gap-2">
                            <span class="font-bold uppercase text-black" id="resultLocation">CIUDAD DE M√âXICO</span>
                            <span>Por: <span class="font-bold underline" id="resultAuthor">Becario Explotado</span></span>
                            <span>Hace 5 minutos</span>
                        </div>
                    </div>
                    
                    <div id="resultContent" class="space-y-6">
                        </div>
                    
                    <div class="mt-12 pt-6 border-t border-gray-300 text-center">
                         <p class="font-mono text-xs italic text-gray-500">¬øTe ofendiste? Env√≠a tu queja a: papelera@ironius.com</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-black text-gray-500 text-center py-6 mt-8 font-mono text-xs">
        <p>IRONIUS ¬© 2024. Somos como El Deforma pero con menos presupuesto.</p>
    </footer>

    <script>
        // ==========================================
        // L√ìGICA DE IRONIUS (MODO DEFORMA/ONION)
        // ==========================================
        const POLLINATIONS_URL = "https://text.pollinations.ai/openai"; 
        
        let currentStyle = 'deforma';

        // DEFINICI√ìN DE REDACTORES (PERSONAS S√ÅTIRA PURA)
        const PERSONAS = {
            deforma: {
                name: "EL DEFORMA CL√ÅSICO",
                role: "Eres el redactor estrella de 'El Deforma' o 'The Onion'.",
                tone: "Pseudoperiod√≠stico, formal pero describiendo situaciones absurdas. C√≠nico. Usas un lenguaje sofisticado para hablar de estupideces.",
                instruction: "Toma el tema y crea una NOTICIA COMPLETAMENTE FALSA Y EXAGERADA. Ignora la realidad. Inventa instituciones (ej. 'Universidad de la Vida', 'Instituto Nacional de Otros Datos'), inventa nombres de personas rid√≠culos."
            },
            barrio: {
                name: "CR√ìNICA √ëERA",
                role: "Eres un cronista urbano exagerado que escribe para un peri√≥dico sensacionalista de barrio.",
                tone: "Usa jerga mexicana callejera (chale, c√°mara, valedor), pero narrando una historia √©pica y absurda.",
                instruction: "Convierte el tema en una leyenda urbana de barrio. Exagera el drama, inventa vecinos chismosos y situaciones ca√≥ticas en el transporte p√∫blico o la tiendita."
            },
            conspiracion: {
                name: "EL OJO QUE TODO LO VE",
                role: "Eres un te√≥rico de la conspiraci√≥n paranoico.",
                tone: "Misterioso, alarmista, usas may√∫sculas para enfatizar 'LA VERDAD'. Conectas cosas que no tienen sentido.",
                instruction: "Toma el tema y dale un giro de ciencia ficci√≥n o control mental gubernamental. Todo es una cortina de humo."
            }
        };

        // --- INTERFAZ ---

        function selectStyle(style) {
            currentStyle = style;
            document.querySelectorAll('.style-card').forEach(el => el.classList.remove('selected'));
            document.getElementById(`style-${style}`).classList.add('selected');
        }

        // --- GENERACI√ìN ---

        async function generateContent() {
            const topic = document.getElementById('topicInput').value.trim();
            if (!topic) return alert("¬°El papel est√° caro! Escribe un tema primero.");

            // UI Changes
            document.getElementById('emptyState').classList.add('hidden');
            document.getElementById('resultState').classList.add('hidden');
            document.getElementById('loadingState').classList.remove('hidden');
            document.getElementById('generateBtn').disabled = true;
            document.getElementById('generateBtn').innerText = "COCINANDO FAKE NEWS...";
            
            try {
                await callIroniusAI(topic);
            } catch (error) {
                console.error(error);
                alert("Nuestros servidores fueron hackeados por un gato. Intenta de nuevo.");
                document.getElementById('loadingState').classList.add('hidden');
                document.getElementById('emptyState').classList.remove('hidden');
            } finally {
                const btn = document.getElementById('generateBtn');
                btn.disabled = false;
                btn.innerHTML = '<i class="ph-bold ph-printer"></i> ¬°CREAR NOTICIA FALSA!';
            }
        }

        async function callIroniusAI(topic) {
            const persona = PERSONAS[currentStyle];
            document.getElementById('sectionLabel').innerText = persona.name;

            const systemPrompt = `
                ${persona.role}
                TU TONO: ${persona.tone}
                INSTRUCCI√ìN CLAVE: ${persona.instruction}
                
                OBJETIVO: Escribir un ART√çCULO DE S√ÅTIRA EXTENSO (m√≠nimo 400 palabras).
                
                REGLAS DE FORMATO (JSON STRICT):
                1. Responde SOLO con JSON v√°lido.
                2. Estructura requerida:
                   {
                     "headline": "Titular de Clickbait Sarc√°stico (ej. 'Estudio confirma que...')",
                     "subtitle": "Un resumen c√≠nico de la noticia falsa",
                     "location": "Lugar ficticio o absurdo (ej. 'Desde el sill√≥n', 'Tlaxcala')",
                     "author": "Nombre gracioso del periodista (ej. 'Lic. Valeriano', 'Tu Ex')",
                     "body": [
                       {"type": "p", "content": "P√°rrafo de introducci√≥n estableciendo la premisa absurda."},
                       {"type": "p", "content": "Desarrollo de la noticia con detalles inventados."},
                       {"type": "quote", "speaker": "Nombre de un Experto Falso", "role": "Cargo rid√≠culo (ej. Doctor en Memes)", "text": "Una cita textual absurda que apoye la noticia."},
                       {"type": "p", "content": "M√°s drama o consecuencias exageradas."},
                       {"type": "quote", "speaker": "Testigo Ocular", "role": "Vecina chismosa", "text": "Otra cita con lenguaje coloquial."},
                       {"type": "p", "content": "Conclusi√≥n pesimista o llamado a la acci√≥n in√∫til."}
                     ]
                   }
                3. SE EXTENSO. No resumas. Detalla la mentira.
                4. Usa humor mexicano.
            `.trim();

            const userPrompt = `El tema es: "${topic}". Escribe una noticia falsa completa burl√°ndote de esto.`;

            const response = await fetch(POLLINATIONS_URL, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    messages: [
                        { role: "system", content: systemPrompt },
                        { role: "user", content: userPrompt }
                    ],
                    model: "openai",
                    jsonMode: true,
                    seed: Math.floor(Math.random() * 10000)
                })
            });

            if (!response.ok) throw new Error(`Error ${response.status}`);
            
            const data = await response.json();
            const aiContent = data.choices[0].message.content;

            let parsedResult;
            try {
                // Limpieza agresiva para asegurar JSON
                const cleanJson = aiContent.replace(/```json/g, '').replace(/```/g, '').trim();
                parsedResult = JSON.parse(cleanJson);
            } catch (e) {
                parsedResult = {
                    headline: "LA IA SE PUSO REBELDE",
                    subtitle: "No pudimos generar la s√°tira, se nos acab√≥ el presupuesto.",
                    location: "Error 404",
                    author: "Skynet",
                    body: [{ type: "p", content: "Hubo un error t√©cnico. Intenta con otro tema m√°s f√°cil, por favor." }]
                };
            }

            renderResult(parsedResult);
            document.getElementById('loadingState').classList.add('hidden');
            document.getElementById('resultState').classList.remove('hidden');
        }

        function renderResult(data) {
            // Inyectar datos de cabecera
            document.getElementById('resultTitle').innerText = data.headline || "Sin Titular";
            document.getElementById('resultSubtitle').innerText = data.subtitle || "";
            document.getElementById('resultLocation').innerText = (data.location || "M√âXICO M√ÅGICO").toUpperCase();
            document.getElementById('resultAuthor').innerText = data.author || "An√≥nimo Cobarde";

            const container = document.getElementById('resultContent');
            container.innerHTML = '';
            
            // Renderizar cuerpo
            if(data.body && Array.isArray(data.body)) {
                data.body.forEach(block => {
                    if (block.type === 'quote') {
                        // Dise√±o de Cita
                        container.innerHTML += `
                            <div class="my-8 relative pl-8 py-2 group">
                                <div class="absolute left-0 top-0 text-6xl text-gray-300 font-headline">‚Äú</div>
                                <p class="font-headline text-2xl text-gray-900 italic leading-snug mb-3">
                                    ${block.text}
                                </p>
                                <div class="flex items-center gap-2">
                                    <div class="h-px w-8 bg-black"></div>
                                    <p class="font-mono text-xs font-bold uppercase tracking-wider text-black">
                                        ${block.speaker} <span class="text-gray-500 font-normal normal-case">‚Äî ${block.role}</span>
                                    </p>
                                </div>
                            </div>
                        `;
                    } else {
                        // Dise√±o de P√°rrafo Period√≠stico (Drop cap en el primero)
                        // Detectamos si es el primer p√°rrafo para ponerle la letra capital
                        const isFirst = container.children.length === 0;
                        const dropCapClass = isFirst 
                            ? "first-letter:text-6xl first-letter:font-black first-letter:text-black first-letter:mr-3 first-letter:float-left first-letter:leading-[0.8]" 
                            : "";
                        
                        container.innerHTML += `
                            <p class="font-serif text-lg md:text-xl leading-relaxed text-gray-800 mb-6 font-light ${dropCapClass}">
                                ${block.content}
                            </p>
                        `;
                    }
                });
            }
        }
    </script>
</body>
</html>
