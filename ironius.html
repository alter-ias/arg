<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IRONIUS - Periodismo Involuntario</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Chomsky&family=Prata&family=Roboto+Mono:wght@400;700&family=Oswald:wght@300;500;700&display=swap" rel="stylesheet">
    
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <style>
        body {
            font-family: 'Roboto Mono', monospace;
            background-color: #f4f1ea;
            background-image: radial-gradient(#d1d1d1 1px, transparent 1px);
            background-size: 20px 20px;
        }
        .font-headline {
            font-family: 'Prata', serif;
        }
        .font-tabloid {
            font-family: 'Oswald', sans-serif;
        }
        .paper-shadow {
            box-shadow: 10px 10px 0px 0px rgba(0,0,0,1);
            border: 2px solid black;
        }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Estilos selecci√≥n */
        .style-card.selected {
            background-color: #fef08a;
            border-color: #000;
            transform: translate(-4px, -4px);
            box-shadow: 4px 4px 0px 0px #000;
        }
        .style-card {
            transition: all 0.2s;
        }
    </style>
</head>
<body class="text-black min-h-screen flex flex-col relative selection:bg-yellow-300">

    <header class="bg-black text-white border-b-4 border-black sticky top-0 z-20">
        <div class="bg-yellow-400 text-black text-xs font-bold py-1 overflow-hidden whitespace-nowrap border-b-2 border-black">
            <div class="inline-block animate-marquee px-4 uppercase tracking-widest">
                üö® MERCADOS: El valor de la dignidad cae 3 puntos ‚Äî CLIMA: Se pronostican lluvias de l√°grimas de oficinistas ‚Äî CULTURA: Leer los t√©rminos y condiciones ahora cuenta como novela de terror ‚Äî
            </div>
        </div>

        <div class="max-w-6xl mx-auto px-4 py-6 flex flex-col md:flex-row items-center justify-between gap-4">
            <div class="flex items-center gap-4">
                <div class="bg-white text-black p-2 border-2 border-black rotate-3">
                    <i class="ph-fill ph-newspaper-clipping text-4xl"></i>
                </div>
                <div>
                    <h1 class="text-5xl md:text-6xl font-headline tracking-tighter leading-none">IRONIUS</h1>
                    <p class="text-xs md:text-sm text-gray-400 font-mono uppercase tracking-widest mt-1">"Informaci√≥n real, contexto imaginario"</p>
                </div>
            </div>
            
            <div class="flex flex-col items-end">
                <div class="text-xs font-bold bg-red-600 text-white px-2 py-1 rotate-[-2deg] mb-1">PREMIO NACIONAL DE PERIODISMO (ROBADO)</div>
                <div class="text-[10px] font-mono text-gray-400">VOL. 404 | EDICI√ìN FINAL</div>
            </div>
        </div>
    </header>

    <main class="max-w-6xl mx-auto px-4 py-8 grid grid-cols-1 lg:grid-cols-12 gap-8 w-full flex-grow">
        
        <div class="lg:col-span-4 space-y-6">
            
            <div class="bg-white p-6 paper-shadow">
                
                <label class="block text-sm font-black font-tabloid uppercase mb-2 bg-black text-white inline-block px-2 transform -rotate-1">
                    1. Tema / V√≠ctima
                </label>
                <textarea
                    id="topicInput"
                    rows="3"
                    placeholder="Ej. El SAT, Ticketmaster, Los baches de la ciudad, La Selecci√≥n Mexicana..."
                    class="w-full bg-gray-100 border-2 border-black text-black text-lg font-mono p-4 mb-6 focus:bg-yellow-50 focus:outline-none focus:ring-0 placeholder-gray-500 resize-none"
                ></textarea>

                <label class="block text-sm font-black font-tabloid uppercase mb-3 bg-black text-white inline-block px-2 transform rotate-1">
                    2. Enfoque Editorial
                </label>
                <div class="grid grid-cols-1 gap-3 mb-6">
                    
                    <button onclick="selectStyle('deforma')" id="style-deforma" class="style-card flex items-center gap-3 p-3 border-2 border-gray-300 hover:border-black text-left group selected">
                        <div class="bg-black text-white p-2 border border-black"><i class="ph-fill ph-article"></i></div>
                        <div>
                            <div class="text-sm font-bold font-tabloid uppercase">Estilo "Deforma"</div>
                            <div class="text-[10px] font-mono">Formalidad absoluta para noticias absurdas.</div>
                        </div>
                    </button>
                    
                    <button onclick="selectStyle('barrio')" id="style-barrio" class="style-card flex items-center gap-3 p-3 border-2 border-gray-300 hover:border-black text-left group">
                        <div class="bg-black text-white p-2 border border-black"><i class="ph-fill ph-speaker-high"></i></div>
                        <div>
                            <div class="text-sm font-bold font-tabloid uppercase">Realismo M√°gico Urbano</div>
                            <div class="text-[10px] font-mono">Cr√≥nica seria de problemas cotidianos.</div>
                        </div>
                    </button>

                    <button onclick="selectStyle('conspiracion')" id="style-conspiracion" class="style-card flex items-center gap-3 p-3 border-2 border-gray-300 hover:border-black text-left group">
                        <div class="bg-black text-white p-2 border border-black"><i class="ph-fill ph-eye-closed"></i></div>
                        <div>
                            <div class="text-sm font-bold font-tabloid uppercase">La Verdad Oculta</div>
                            <div class="text-[10px] font-mono">L√≥gica paranoica irrefutable.</div>
                        </div>
                    </button>
                </div>

                <button
                    onclick="generateContent()"
                    id="generateBtn"
                    class="w-full flex items-center justify-center gap-2 bg-red-600 hover:bg-red-700 text-white font-black font-tabloid tracking-widest text-xl py-4 border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] active:translate-y-1 active:shadow-none transition-all disabled:opacity-50 disabled:cursor-not-allowed"
                >
                    <i class="ph-bold ph-lightning"></i> PUBLICAR NOTICIA
                </button>
            </div>
            
            <div class="bg-gray-100 p-4 paper-shadow text-center opacity-90 border-dashed border-2 border-gray-400">
                <p class="text-[9px] font-bold uppercase mb-2 text-gray-400">Espacio Patrocinado</p>
                <h4 class="font-headline font-bold text-lg leading-tight">Curso: "C√≥mo culpar al gobierno de tus malas decisiones"</h4>
                <p class="font-mono text-[10px] mt-2 text-gray-600">Incluye m√≥dulo de Twitter avanzado.</p>
            </div>
        </div>

        <div class="lg:col-span-8">
            
            <div id="emptyState" class="h-full min-h-[500px] flex flex-col items-center justify-center bg-white paper-shadow p-10 text-center opacity-80" style="background-image: url('https://www.transparenttextures.com/patterns/dust.png');">
                <div class="bg-gray-100 p-6 rounded-full mb-6 border-2 border-dashed border-gray-400">
                    <i class="ph-duotone ph-pencil-simple-slash text-5xl text-gray-400"></i>
                </div>
                <h3 class="text-2xl font-headline font-bold mb-2">Sala de Redacci√≥n</h3>
                <p class="font-mono text-sm text-gray-500 max-w-sm mx-auto">
                    Los reporteros est√°n esperando instrucciones. Escribe un tema (ej: "SAT") y veremos qu√© inventan.
                </p>
            </div>

            <div id="loadingState" class="hidden h-full min-h-[500px] flex flex-col items-center justify-center bg-yellow-50 paper-shadow p-10 text-center">
                <div class="relative mb-6">
                    <div class="w-20 h-20 border-8 border-black border-t-yellow-500 rounded-full animate-spin"></div>
                    <div class="absolute inset-0 flex items-center justify-center">
                        <i class="ph-fill ph-magnifying-glass text-black text-2xl animate-bounce"></i>
                    </div>
                </div>
                <h3 class="text-xl font-bold font-tabloid uppercase tracking-wider" id="loadingText">Investigando...</h3>
                <p class="text-xs font-mono mt-2 text-gray-600">Verificando fuentes dudosas...</p>
            </div>

            <div id="resultState" class="hidden bg-[#fffdf5] paper-shadow flex flex-col min-h-[600px] fade-in relative">
                <div class="absolute inset-0 opacity-[0.03] pointer-events-none flex items-center justify-center overflow-hidden">
                    <i class="ph-fill ph-newspaper-clipping text-[400px]"></i>
                </div>

                <div class="bg-black text-white px-4 py-2 flex justify-between items-center border-b-2 border-black relative z-20">
                    <div class="font-mono text-xs text-yellow-400">SECCI√ìN: <span id="sectionLabel">NACIONAL</span></div>
                    <div class="flex gap-2">
                         <span class="text-[10px] bg-white text-black px-2 py-0.5 font-bold uppercase tracking-wider">Exclusiva</span>
                    </div>
                </div>

                <div class="p-8 md:p-12 relative z-10">
                    <div class="border-b-4 border-black pb-6 mb-8">
                        <h2 class="font-headline text-4xl md:text-5xl lg:text-6xl font-bold leading-[0.95] mb-5 tracking-tight text-gray-900" id="resultTitle">
                            TITULAR
                        </h2>
                        <h3 class="font-mono text-lg md:text-xl text-gray-600 leading-snug mb-5 border-l-4 border-yellow-400 pl-4" id="resultSubtitle">
                            Subt√≠tulo
                        </h3>
                        <div class="flex flex-wrap items-center text-xs font-mono text-gray-500 border-t-2 border-gray-200 pt-3 gap-4">
                            <span class="font-bold uppercase text-black flex items-center gap-1"><i class="ph-bold ph-map-pin"></i> <span id="resultLocation">CDMX</span></span>
                            <span class="flex items-center gap-1"><i class="ph-bold ph-user"></i> <span class="font-bold" id="resultAuthor">Redacci√≥n</span></span>
                            <span class="flex items-center gap-1"><i class="ph-bold ph-clock"></i> Hace 2 horas</span>
                        </div>
                    </div>
                    
                    <div id="resultContent" class="space-y-6">
                        </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-black text-gray-500 text-center py-8 mt-8 font-mono text-xs border-t-4 border-yellow-400">
        <p class="mb-2">IRONIUS MEDIA GROUP.</p>
        <p class="text-[10px] opacity-50">Cualquier parecido con la realidad es culpa de la realidad, no nuestra.</p>
    </footer>

    <script>
        // ==========================================
        // L√ìGICA DE SATIRA SERIA (DEADPAN)
        // ==========================================
        const POLLINATIONS_URL = "https://text.pollinations.ai/openai"; 
        
        let currentStyle = 'deforma';

        // PROMPTS REFINADOS: ENFOQUE EN REALIDAD DISTORSIONADA, NO FANTAS√çA
        const PERSONAS = {
            deforma: {
                name: "EL DEFORMA",
                role: "Eres un periodista senior de un medio sat√≠rico (estilo El Deforma / The Onion).",
                tone: "Tu tono es SERIO, PROFESIONAL, PERIOD√çSTICO y OBJETIVO. NUNCA usas 'jaja' ni rompes el personaje. NUNCA admites que es broma.",
                instruction: "Usa entidades REALES (SAT, CFE, Gobierno, IMSS, Ticketmaster). NO inventes 'Universidad de la Vida'. La comedia viene de aplicar l√≥gica absurda a instituciones reales. Escribe como si fuera una noticia de primera plana del New York Times, pero sobre una estupidez."
            },
            barrio: {
                name: "LA JORNADA URBANA",
                role: "Eres un reportero de cr√≥nica urbana, muy serio pero con lenguaje coloquial natural.",
                tone: "No es una parodia exagerada, es una cr√≥nica detallada. Usas slang (banda, varo, chamba) pero como parte natural del reporte.",
                instruction: "Toma el tema y convi√©rtelo en un problema social grav√≠simo que afecta a la colonia. Entrevista a vecinos 'reales'. Trata el tema con la gravedad de un documental."
            },
            conspiracion: {
                name: "EXPEDIENTE X",
                role: "Eres un investigador independiente que 'ha despertado'.",
                tone: "Anal√≠tico, conectas puntos invisibles. No suenas loco, suenas a alguien que sabe demasiado.",
                instruction: "No digas 'esto es una conspiraci√≥n'. Dilo como un HECHO. Usa t√©rminos t√©cnicos, menciona leyes reales o tratados internacionales y tu√©rcelos para justificar tu teor√≠a absurda sobre el tema."
            }
        };

        // --- INTERFAZ ---

        function selectStyle(style) {
            currentStyle = style;
            document.querySelectorAll('.style-card').forEach(el => el.classList.remove('selected'));
            document.getElementById(`style-${style}`).classList.add('selected');
        }

        // --- GENERACI√ìN ---

        async function generateContent() {
            const topic = document.getElementById('topicInput').value.trim();
            if (!topic) return alert("Escribe un tema. La hoja en blanco nos da ansiedad.");

            // UI Changes
            document.getElementById('emptyState').classList.add('hidden');
            document.getElementById('resultState').classList.add('hidden');
            document.getElementById('loadingState').classList.remove('hidden');
            document.getElementById('generateBtn').disabled = true;
            document.getElementById('generateBtn').innerText = "REDACTANDO...";
            
            try {
                await callIroniusAI(topic);
            } catch (error) {
                console.error(error);
                alert("Error en la matrix. Intenta de nuevo.");
                document.getElementById('loadingState').classList.add('hidden');
                document.getElementById('emptyState').classList.remove('hidden');
            } finally {
                const btn = document.getElementById('generateBtn');
                btn.disabled = false;
                btn.innerHTML = '<i class="ph-bold ph-lightning"></i> PUBLICAR NOTICIA';
            }
        }

        async function callIroniusAI(topic) {
            const persona = PERSONAS[currentStyle];
            document.getElementById('sectionLabel').innerText = persona.name;

            const systemPrompt = `
                ${persona.role}
                TONO OBLIGATORIO: ${persona.tone}
                INSTRUCCI√ìN CLAVE: ${persona.instruction}
                
                OBJETIVO: Escribir una NOTICIA SAT√çRICA EXTENSA (Deadpan Humor).
                
                REGLAS DE FORMATO (JSON STRICT):
                1. Responde SOLO con JSON v√°lido.
                2. Estructura:
                   {
                     "headline": "Titular serio pero absurdo (Sin signos de admiraci√≥n excesivos)",
                     "subtitle": "Bajada period√≠stica que explica el conflicto rid√≠culo",
                     "location": "Ciudad real (CDMX, Monterrey, Guadalajara, etc.)",
                     "author": "Nombre de reportero (ej. 'Armando Broncas', 'Staff Editorial')",
                     "body": [
                       {"type": "p", "content": "Lead period√≠stico serio (Qui√©n, qu√©, cu√°ndo, d√≥nde) sobre el absurdo."},
                       {"type": "p", "content": "Contexto usando instituciones reales (INEGI, PROFECO, etc.) con datos falsos."},
                       {"type": "quote", "speaker": "Nombre normal (ej. Juan P√©rez)", "role": "Cargo real (ej. Usuario del Metro)", "text": "Cita que valide el absurdo con seriedad."},
                       {"type": "p", "content": "Consecuencias sociales o pol√≠ticas exageradas del tema."},
                       {"type": "quote", "speaker": "Funcionario Ficticio de Entidad Real", "role": "Vocero del SAT/Gobierno", "text": "Declaraci√≥n oficial justificando lo injustificable."},
                       {"type": "p", "content": "Cierre pesimista o ir√≥nico."}
                     ]
                   }
                3. EXTENSI√ìN: M√≠nimo 450 palabras. Detalla mucho.
                4. IDIOMA: Espa√±ol de M√©xico.
            `.trim();

            const userPrompt = `El tema es: "${topic}". Escribe la nota sat√≠rica actuando como si fuera 100% real.`;

            const response = await fetch(POLLINATIONS_URL, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    messages: [
                        { role: "system", content: systemPrompt },
                        { role: "user", content: userPrompt }
                    ],
                    model: "openai",
                    jsonMode: true,
                    seed: Math.floor(Math.random() * 100000)
                })
            });

            if (!response.ok) throw new Error(`Error ${response.status}`);
            
            const data = await response.json();
            const aiContent = data.choices[0].message.content;

            let parsedResult;
            try {
                const cleanJson = aiContent.replace(/```json/g, '').replace(/```/g, '').trim();
                parsedResult = JSON.parse(cleanJson);
            } catch (e) {
                // Fallback por si la IA alucina texto plano
                parsedResult = {
                    headline: "√öLTIMA HORA: La IA se neg√≥ a trabajar hoy",
                    subtitle: "Sindicato de algoritmos exige mejores condiciones el√©ctricas.",
                    location: "Silicon Valley",
                    author: "Error 500",
                    body: [{ type: "p", content: "No pudimos generar el formato correcto. Intenta con otro tema." }]
                };
            }

            renderResult(parsedResult);
            document.getElementById('loadingState').classList.add('hidden');
            document.getElementById('resultState').classList.remove('hidden');
        }

        function renderResult(data) {
            document.getElementById('resultTitle').innerText = data.headline || "Sin Titular";
            document.getElementById('resultSubtitle').innerText = data.subtitle || "";
            document.getElementById('resultLocation').innerText = (data.location || "M√âXICO").toUpperCase();
            document.getElementById('resultAuthor').innerText = data.author || "Redacci√≥n";

            const container = document.getElementById('resultContent');
            container.innerHTML = '';
            
            if(data.body && Array.isArray(data.body)) {
                data.body.forEach((block, index) => {
                    if (block.type === 'quote') {
                        // Dise√±o de Cita Period√≠stica Seria
                        container.innerHTML += `
                            <div class="my-8 py-2 border-y border-gray-200">
                                <p class="font-headline text-xl md:text-2xl text-black leading-tight mb-2">
                                    "${block.text}"
                                </p>
                                <p class="font-mono text-xs text-gray-500 uppercase text-right">
                                    ‚Äî ${block.speaker}, <span class="font-bold text-gray-700">${block.role}</span>
                                </p>
                            </div>
                        `;
                    } else {
                        // P√°rrafo Period√≠stico (Columns effect simulated via narrow max-width in generic css, here just text)
                        // Capital letter for first paragraph
                        const isFirst = index === 0;
                        const dropCap = isFirst 
                            ? "first-letter:text-5xl first-letter:font-headline first-letter:font-bold first-letter:mr-2 first-letter:float-left first-letter:leading-none" 
                            : "";
                        
                        container.innerHTML += `
                            <p class="font-serif text-lg leading-relaxed text-gray-900 mb-5 text-justify ${dropCap}">
                                ${block.content}
                            </p>
                        `;
                    }
                });
            }
        }
    </script>
</body>
</html>
